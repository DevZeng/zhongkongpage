webpackJsonp([7],{"7ODa":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=void 0,l=void 0,o=void 0,i=void 0,n={data:function(){return{url:json.https+"/txUpload_t",tableData:[],gradeList:[],form1:[],form2:[],form3:[{apk_url:[]}],form4:[],form5:[],cur_page:1,select_cate:"",AddVisible1:!1,AddVisible2:!1,AddVisible3:!1,delVisible1:!1,delVisible2:!1,delVisible3:!1,delVisible4:!1,ShowVisible1:!1,ShowVisible2:!1,idx:-1,idx1:-1,total:0,activeName:"grade"}},created:function(){this.getGrade()},methods:{handleClick:function(e,t){console.log(e,t)},handleCurrentChange:function(e){this.cur_page=e,this.getData()},handleAdd1:function(){this.form1={main_name:""},this.AddVisible1=!0},handleAdd2:function(){this.form2={id:"",two_name:""},this.AddVisible2=!0},handleAdd3:function(e,t){this.form3={apk_url:[],two_id:"",domain_name:""},this.AddVisible3=!0;var s=this;$.ajax({type:"get",url:json.https+"/select_apk",data:{two_id:t.two_id},success:function(e){console.log("获取包信息返回"),console.log(e),e.data.length>0?e.data[0].apk_url=[{url:e.data[0].apk_address,name:e.data[0].apk_edition+".apk"}]:e.data=[{apk_url:[],two_id:t.two_id,domain_name:"moren"}],s.form3=e.data[0]}})},handleShow1:function(e,t){this.form4={apk_address:"",apk_edition:"",domain_name:"",upatetime:""},this.ShowVisible1=!0;var s=this;$.ajax({type:"get",url:json.https+"/select_apk",data:{two_id:t.two_id},success:function(e){console.log("获取包信息返回"),console.log(e),0==e.data.length&&(e.data=[{apk_address:"无",apk_edition:"无",domain_name:"无",upatetime:"无"}]),s.form4=e.data[0]}})},handleShow2:function(e){this.ShowVisible2=!0;var t=this;$.ajax({type:"get",url:json.https+"/user/select_c_all_apply",data:{class_id:e},headers:{Token:sessionStorage.getItem("face_token")},success:function(e){console.log("班级教师列表"),console.log(e),t.form5=e.data}})},handleDelete1:function(e,t){a=t.class_id,this.idx=e,this.delVisible1=!0},handleDelete2:function(e,t){a=t.class_id,o=t.stu_number,this.delVisible2=!0},handleDelete3:function(e,t){l=t.id,this.idx1=e,this.delVisible3=!0},handleDelete4:function(e,t){a=t.class_id,i=t.user_id,this.delVisible4=!0},getData:function(){var e=this;$.ajax({type:"get",url:json.https+"/class/select_all_class",data:{start:e.cur_page},success:function(t){console.log("班级列表"),console.log(t),e.total=t.total,e.tableData=t.data}})},getGrade:function(){var e=this;$.ajax({type:"get",url:json.https+"/select_main",success:function(t){console.log("功能分类列表"),console.log(t),e.gradeList=t.data}})},search:function(){var e=this;e.select_cate?(console.log(e.select_cate),$.ajax({type:"get",url:json.https+"/select_two",data:{id:e.select_cate},success:function(t){console.log("根据功能分类搜索设备分类返回"),console.log(t),e.total=0,e.tableData=t.data}})):e.$message.error("请选择年级")},AddGrade:function(){var e=this;e.form1.main_name?(console.log(e.form1.main_name),$.ajax({type:"post",url:json.https+"/insert_main",data:{main_name:e.form1.main_name},headers:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log("添加功能分类返回"),console.log(t),200==t.code?(e.$message.success("添加成功"),e.getGrade(),e.AddVisible1=!1):e.$message.error(t.error)}})):e.$message.error("请填写信息")},AddClass:function(){var e=this;e.form2.id&&e.form2.two_name?(console.log(e.form2.id),console.log(e.form2.two_name),$.ajax({type:"post",url:json.https+"/insert_two",data:e.form2,headers:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log("添加设备分类返回"),console.log(t),200==t.code?(e.getData(),e.$message.success("添加成功"),e.AddVisible2=!1):e.$message.error(t.error)}})):e.$message.error("请填写信息")},Addpackage:function(){var e=this;if(e.form3.apk_url&&e.form3.domain_name&&e.form3.apk_edition){console.log(e.form3.apk_url),console.log(e.form3.domain_name),console.log(e.form3.apk_edition);var t=e.form3;t.apk_address=t.apk_url[0].url,console.log(e.form3),console.log(t),t.id?$.ajax({type:"put",url:json.https+"/update_apk",data:t,headers:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log("修改包信息返回"),console.log(t),200==t.code?(e.$message.success("修改成功"),e.AddVisible3=!1):e.$message.error(t.msg)}}):$.ajax({type:"post",url:json.https+"/insert_apk",data:t,headers:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log("添加信息返回"),console.log(t),200==t.code?(e.$message.success("添加成功"),e.AddVisible3=!1):e.$message.error(t.msg)}})}else e.$message.error("请填写信息")},removeStudent:function(){var e=this;$.ajax({type:"delete",url:json.https+"/class_m/delete_stu/"+o,headers:{Token:sessionStorage.getItem("face_token")},success:function(t){console.log("移除学生返回"),console.log(t),200==t.code?(e.handleShow1(a),e.$message.success("移除成功"),e.delVisible2=!1):e.$message.error(t.msg)}})},removeTeacher:function(){var e=this;$.ajax({type:"delete",url:json.https+"/user/delete_ter/"+i,headers:{Token:sessionStorage.getItem("face_token")},success:function(t){console.log("删除教师信息返回"),console.log(t),t.sucesss?(e.handleShow2(a),e.$message.success("删除成功"),e.delVisible4=!1):e.$message.error(t.msg)}})},deleteRow:function(){console.log(a);var e=this;$.ajax({type:"delete",url:json.https+"/class/delete_class/"+a,headers:{Token:sessionStorage.getItem("face_token")},success:function(t){console.log("删除班级返回"),console.log(t),t.sucesss?(e.tableData.splice(e.idx,1),e.$message.success("删除成功"),e.delVisible1=!1):e.$message.error(t.error)}})},deleteRow1:function(){console.log(l);var e=this;$.ajax({type:"delete",url:json.https+"/class/delete_grade/"+l,headers:{Token:sessionStorage.getItem("face_token")},success:function(t){console.log("删除年级返回"),console.log(t),t.sucesss?(e.tableData.splice(e.idx1,1),e.getGrade(),e.$message.success("删除成功"),e.delVisible3=!1):e.$message.error(t.error)}})},Rsuccess:function(e,t,s){console.log(t),this.form3.apk_url=[{name:t.name,url:t.response.msg}]},Overrun:function(e,t){this.$message.error("只能上传一个文件")},Remove:function(e,t){console.log(e),this.form3.apk_url=[]},clearFiles:function(){this.$refs.upload.clearFiles()}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table"},[s("div",{staticClass:"crumbs"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[s("i",{staticClass:"el-icon-tickets"}),e._v(" 包管理")])],1)],1),e._v(" "),s("div",{staticClass:"container"},[s("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"功能分类管理",name:"grade"}},[s("div",{staticClass:"handle-box"},[s("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:e.handleAdd1}},[e._v("添加功能分类")])],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.gradeList,border:""}},[s("el-table-column",{attrs:{prop:"id",label:"ID",width:"150"}}),e._v(" "),s("el-table-column",{attrs:{prop:"main_name",label:"分类名称",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"creatime",label:"更新时间",sortable:""}})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),s("el-tab-pane",{attrs:{label:"设备分类管理",name:"class"}},[s("div",{staticClass:"handle-box"},[s("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:e.handleAdd2}},[e._v("添加设备分类")]),e._v(" "),s("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"选择功能分类"},model:{value:e.select_cate,callback:function(t){e.select_cate=t},expression:"select_cate"}},e._l(e.gradeList,function(e,t){return s("el-option",{key:t,attrs:{label:e.main_name,value:e.id}})})),e._v(" "),s("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")])],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[s("el-table-column",{attrs:{prop:"id",label:"功能分类ID",width:"150"}}),e._v(" "),s("el-table-column",{attrs:{prop:"two_id",label:"设备分类ID",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"two_name",label:"设备分类名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"creatime",label:"创建时间",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(s){e.handleAdd3(t.$index,t.row)}}},[e._v("修改包")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(s){e.handleShow1(t.$index,t.row)}}},[e._v("查看包")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"添加年级",visible:e.AddVisible1,width:"40%"},on:{"update:visible":function(t){e.AddVisible1=t}}},[s("el-form",{ref:"form1",attrs:{model:e.form1,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"功能分类名称"}},[s("el-input",{model:{value:e.form1.main_name,callback:function(t){e.$set(e.form1,"main_name",t)},expression:"form1.main_name"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.AddVisible1=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.AddGrade}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"添加",visible:e.AddVisible2,width:"30%"},on:{"update:visible":function(t){e.AddVisible2=t}}},[s("el-form",{ref:"form2",attrs:{model:e.form2,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"功能分类"}},[s("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"选择功能分类"},model:{value:e.form2.id,callback:function(t){e.$set(e.form2,"id",t)},expression:"form2.id"}},e._l(e.gradeList,function(e,t){return s("el-option",{key:t,attrs:{label:e.main_name,value:e.id}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"设备分类名称"}},[s("el-input",{staticClass:"handle-select mr10",model:{value:e.form2.two_name,callback:function(t){e.$set(e.form2,"two_name",t)},expression:"form2.two_name"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.AddVisible2=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.AddClass}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"包管理",visible:e.AddVisible3,width:"30%"},on:{"update:visible":function(t){e.AddVisible3=t}}},[s("el-form",{ref:"form3",attrs:{model:e.form3,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"包地址"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:e.url,"on-remove":e.Remove,"on-success":e.Rsuccess,"on-exceed":e.Overrun,multiple:"",limit:1,"file-list":e.form3.apk_url}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"包版本号"}},[s("el-input",{attrs:{placeholder:"请填写版本号"},model:{value:e.form3.apk_edition,callback:function(t){e.$set(e.form3,"apk_edition",t)},expression:"form3.apk_edition"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.AddVisible3=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.Addpackage}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"包信息",visible:e.ShowVisible1,width:"70%"},on:{"update:visible":function(t){e.ShowVisible1=t}}},[s("el-form",{ref:"form4",attrs:{model:e.form4,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"包地址"}},[s("span",{domProps:{textContent:e._s(e.form4.apk_address)}})]),e._v(" "),s("el-form-item",{attrs:{label:"包版本号"}},[s("span",{domProps:{textContent:e._s(e.form4.apk_edition)}})]),e._v(" "),s("el-form-item",{attrs:{label:"更新时间"}},[s("span",{domProps:{textContent:e._s(e.form4.upatetime)}})])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"提示",visible:e.delVisible1,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible1=t}}},[s("div",{staticClass:"del-dialog-cnt"},[e._v("删除班级并将该班级学生从班级移出，删除不可恢复，是否确定删除？")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.delVisible1=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"提示",visible:e.delVisible2,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible2=t}}},[s("div",{staticClass:"del-dialog-cnt"},[e._v("是否将该学生从班级内移除？")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.delVisible2=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.removeStudent}},[e._v("确 定")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"提示",visible:e.delVisible4,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible4=t}}},[s("div",{staticClass:"del-dialog-cnt"},[e._v("是否删除该老师的所有信息？")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.delVisible4=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.removeTeacher}},[e._v("确 定")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"提示",visible:e.delVisible3,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible3=t}}},[s("div",{staticClass:"del-dialog-cnt"},[e._v("是否将该年级删除？")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.delVisible3=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow1}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var c=s("VU/8")(n,r,!1,function(e){s("yT7c")},null,null);t.default=c.exports},yT7c:function(e,t){}});